<!--index.wxml-->
<view class="container">
  <!-- 隐藏的视频播放组件，用于实际播放视频 -->
  <video id="myVideo" style="width: 1px; height: 1px; opacity: 0;"></video>
  
  <!-- 用户信息模块 -->
  <view class="userinfo">
    <button wx:if="{{!hasUserInfo && canIUse}}" open-type="getUserInfo" bindgetuserinfo="getUserInfo">
      获取头像昵称
    </button>
    <block wx:else>
      <image wx:if="{{hasUserInfo}}" class="userinfo-avatar" src="{{userInfo.avatarUrl}}" mode="aspectFill"></image>
      <text class="userinfo-nickname">{{hasUserInfo ? userInfo.nickName : '未登录'}}</text>
      <button wx:if="{{hasUserInfo}}" class="logout-btn" bindtap="logout">退出登录</button>
    </block>
  </view>

  <!-- 短视频模块 -->
  <view class="video-section">
    <view class="section-header">
      <text class="section-title">热门视频</text>
      <text class="more-link">更多</text>
    </view>
    
    <!-- 横向滚动视频列表 -->
    <scroll-view class="video-scroll-list" scroll-x enable-flex>
      <!-- 视频列表 -->
      <block wx:if="{{videoList.length > 0}}">
        <view wx:for="{{videoList}}" wx:key="id" class="video-item" bindtap="playVideo" data-id="{{item.id}}" data-url="{{item.url}}">
          <view class="video-thumbnail-container">
            <image class="video-thumbnail" src="{{item.thumbnail}}" mode="aspectFill"></image>
            <view class="video-duration">{{item.duration}}</view>
            <view class="play-icon"></view>
          </view>
          <text class="video-title">{{item.title}}</text>
          <text class="video-views">{{item.views}} 次观看</text>
        </view>
      </block>
      
      <!-- 视频列表为空 -->
      <view wx:elif="{{!isVideoLoading}}" class="empty-video-state">
        <text class="empty-video-text">暂无视频数据</text>
      </view>
      
      <!-- 视频加载中 -->
      <view wx:if="{{isVideoLoading}}" class="video-loading">
        <view class="loading-spinner-small"></view>
      </view>
    </scroll-view>
  </view>

  <!-- 文章列表滚动模块 -->
  <view class="article-scroll-section">
    <!-- 已注释掉文章列表标题区域
    <view class="article-scroll-header">
      <view class="section-title">文章列表</view>
    </view>
    -->
    
    <!-- 滚动式文章列表 -->
    <scroll-view class="article-scroll-list" scroll-y enable-flex>
      <!-- 文章列表 -->
      <block wx:if="{{articleList.length > 0}}">
        <view wx:for="{{articleList}}" wx:key="id" class="article-item" bindtap="navigateToArticleDetail" data-id="{{item.id}}">
          <view class="article-content" style="margin-right: 0;">
            <text class="article-title">{{item.title}}</text>
            <text class="article-summary">{{item.summary}}</text>
            <view class="article-meta">
              <text class="article-author">{{item.author}}</text>
              <text class="article-time">{{item.publishTime}}</text>
              <text class="article-reads">{{item.readCount}} 阅读</text>
            </view>
          </view>
        </view>
      </block>
      
      <!-- 空状态 -->
      <view wx:elif="{{!isLoading}}" class="empty-state">
        <text class="empty-text">暂无文章数据</text>
      </view>
      
      <!-- 加载中 -->
      <view wx:if="{{isLoading && articleList.length === 0}}" class="loading-state">
        <view class="loading-spinner"></view>
        <text class="loading-text">加载中...</text>
      </view>
      
      <!-- 加载更多 -->
      <view wx:if="{{isLoading && articleList.length > 0}}" class="loading-more">
        <view class="loading-spinner-small"></view>
        <text class="loading-more-text">加载更多...</text>
      </view>
      
      <!-- 没有更多数据 -->
      <view wx:if="{{!hasMoreData && articleList.length > 0}}" class="no-more-data">
        <text class="no-more-text">没有更多了</text>
      </view>
    </scroll-view>
  </view>

  <!-- 底部信息 -->
  <view class="footer">
    <text class="footer-text">© 2023 文章阅读小程序</text>
  </view>
</view>